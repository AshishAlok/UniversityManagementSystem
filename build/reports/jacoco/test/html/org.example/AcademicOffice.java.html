<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>AcademicOffice.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">AIIMSPortal</a> &gt; <a href="index.source.html" class="el_package">org.example</a> &gt; <span class="el_source">AcademicOffice.java</span></div><h1>AcademicOffice.java</h1><pre class="source lang-java linenums">package org.example;
import javax.xml.transform.Result;
import java.io.BufferedReader;
import java.io.BufferedWriter;
import java.io.FileReader;
import java.io.FileWriter;
import java.sql.*;
import java.util.ArrayList;
import java.util.Scanner;
public class AcademicOffice extends AbstractCommonFunctions{
    private String officerId;
<span class="nc" id="L12">    protected Connection con = null;</span>
    AcademicOffice(String id )
<span class="nc" id="L14">    {</span>
<span class="nc" id="L15">        id = removeSpaces(id);</span>
<span class="nc" id="L16">        this.officerId = id;</span>
<span class="nc" id="L17">        GetConnection gtCon = new GetConnection();</span>
<span class="nc" id="L18">        this.con = gtCon.getConnection();</span>
<span class="nc" id="L19">    }</span>

    boolean changeProfileNumber(String contact) throws SQLException {
<span class="nc" id="L22">        contact = removeSpaces(contact);</span>
//        insert into admin (admin_name,admin_id,contact) values ('Staff Dean’s office','staffdeanoffice@iitrpr.ac.in','NA');
<span class="nc" id="L24">        String updateQuery = &quot;update admin set contact = ? where admin_id = ? &quot;;</span>
<span class="nc" id="L25">            PreparedStatement preparedStatement = this.con.prepareStatement(updateQuery);</span>
<span class="nc" id="L26">            preparedStatement.setString(1,contact);</span>
<span class="nc" id="L27">            preparedStatement.setString(2,removeSpaces(this.officerId));</span>

<span class="nc" id="L29">            preparedStatement.execute();</span>
<span class="nc" id="L30">            preparedStatement.close();</span>
<span class="nc" id="L31">        return true;</span>
    }

    boolean changeProfileName(String name) throws SQLException {
<span class="nc" id="L35">        name = removeSpaces(name);</span>
//        insert into admin (admin_name,admin_id,contact) values ('Staff Dean’s office','staffdeanoffice@iitrpr.ac.in','NA');
<span class="nc" id="L37">        String updateQuery = &quot;update admin set admin_name = ? where admin_id = ? &quot;;</span>
<span class="nc" id="L38">            PreparedStatement preparedStatement = this.con.prepareStatement(updateQuery);</span>
<span class="nc" id="L39">            preparedStatement.setString(1,removeSpaces(name));</span>
<span class="nc" id="L40">            preparedStatement.setString(2,removeSpaces(this.officerId));</span>

<span class="nc" id="L42">            preparedStatement.execute();</span>
<span class="nc" id="L43">            preparedStatement.close();</span>

<span class="nc" id="L45">        return true;</span>

    }

    private boolean setSession(int year,int session,int status) throws SQLException {
<span class="nc" id="L50">        String delQuery = &quot;delete from current_session&quot;;</span>
<span class="nc" id="L51">        String startQuery = &quot;insert into current_session (current_year, current_session, status) values (?, ?, ?)&quot;;</span>
<span class="nc" id="L52">        String takesQuery = &quot;create table student_record_&quot;+String.valueOf(year) +&quot; (&quot; +</span>
                &quot;student_id varchar(50) NOT NULL,&quot; +
                &quot;course_id varchar(50) NOT NULL,&quot; +
                &quot;semester INT NOT NULL,&quot; +
                &quot;grades varchar NOT NULL,&quot;+
                &quot;credits numeric(10,2) NOT NULL,&quot; +
                &quot;primary key(student_id,course_id,semester),&quot; +
                &quot;foreign key(student_id) references student(student_id),&quot; +
                &quot;foreign key(course_id) references course(course_id)&quot; +
                &quot;); &quot;;
<span class="nc" id="L62">        String isNewYear = &quot;Select * from current_session&quot;;</span>
<span class="nc" id="L63">        boolean newYear = false;</span>
        try
        {
<span class="nc" id="L66">            PreparedStatement preparedStatement = this.con.prepareStatement(isNewYear);</span>
<span class="nc" id="L67">            ResultSet rs = preparedStatement.executeQuery();</span>

<span class="nc bnc" id="L69" title="All 2 branches missed.">            if(rs.next())</span>
            {
<span class="nc bnc" id="L71" title="All 2 branches missed.">                if(rs.getInt(&quot;current_year&quot;) != year)</span>
                {
<span class="nc" id="L73">                    newYear = true;</span>
                }
            }
            else {
<span class="nc" id="L77">                newYear = true;</span>
            }
<span class="nc bnc" id="L79" title="All 2 branches missed.">            if(newYear)</span>
            {
<span class="nc" id="L81">                preparedStatement = this.con.prepareStatement(takesQuery);</span>
<span class="nc" id="L82">                preparedStatement.execute();</span>
            }
<span class="nc" id="L84">           preparedStatement = this.con.prepareStatement(delQuery);</span>
<span class="nc" id="L85">            preparedStatement.execute();</span>
<span class="nc" id="L86">            preparedStatement = this.con.prepareStatement(startQuery);</span>
<span class="nc" id="L87">            preparedStatement.setInt(1,year);</span>
<span class="nc" id="L88">            preparedStatement.setInt(2,session);</span>
<span class="nc" id="L89">            preparedStatement.setInt(3,status);</span>
<span class="nc" id="L90">            preparedStatement.execute();</span>

<span class="nc bnc" id="L92" title="All 2 branches missed.">            if(session == 8)</span>
            {
<span class="nc" id="L94">                String str = &quot;delete from enrolled_credits&quot;;</span>
<span class="nc" id="L95">                preparedStatement = this.con.prepareStatement(str);</span>
<span class="nc" id="L96">                preparedStatement.execute();</span>

<span class="nc" id="L98">                String query = &quot;delete from course_offering &quot;;</span>
<span class="nc" id="L99">                preparedStatement = this.con.prepareStatement(query);</span>
<span class="nc" id="L100">                preparedStatement.execute();</span>
            }
<span class="nc" id="L102">            preparedStatement.close();</span>



<span class="nc" id="L106">        }catch (SQLException e)</span>
        {
<span class="nc" id="L108">            System.out.println(e.getMessage());</span>
<span class="nc" id="L109">            return false;</span>
<span class="nc" id="L110">        }</span>
<span class="nc" id="L111">        System.out.println(&quot;Session created succesfully!&quot;);</span>
<span class="nc" id="L112">        return true;</span>
    }
    private boolean createActivity(int status)
    {
<span class="nc" id="L116">        String updateQuery = &quot;update current_session set status = ?&quot;;</span>
        try{
<span class="nc" id="L118">            PreparedStatement preparedStatement = this.con.prepareStatement(updateQuery);</span>
<span class="nc" id="L119">            preparedStatement.setInt(1,status);</span>

<span class="nc" id="L121">            preparedStatement.execute();</span>
<span class="nc" id="L122">            preparedStatement.close();</span>

<span class="nc" id="L124">        }catch(SQLException err)</span>
        {
<span class="nc" id="L126">            System.out.println(err.getMessage());</span>
<span class="nc" id="L127">            return false;</span>
<span class="nc" id="L128">        }</span>
<span class="nc" id="L129">        return true;</span>
    }
    boolean isAddCourseActive()
    {
<span class="nc" id="L133">        String query = &quot;select * from current_session&quot;;</span>
<span class="nc" id="L134">        boolean isActive = false;</span>
        try{
<span class="nc" id="L136">            PreparedStatement preparedStatement = this.con.prepareStatement(query);</span>
<span class="nc" id="L137">            ResultSet rs = preparedStatement.executeQuery();</span>
<span class="nc bnc" id="L138" title="All 2 branches missed.">            if(rs.next())</span>
            {
<span class="nc bnc" id="L140" title="All 2 branches missed.">                if(rs.getInt(&quot;status&quot;) == this.SEMSTART )</span>
                {
<span class="nc" id="L142">                    isActive = true;</span>
                }
            }


<span class="nc" id="L147">            preparedStatement.close();</span>
<span class="nc" id="L148">            rs.close();</span>
<span class="nc" id="L149">        }catch(SQLException err)</span>
        {
<span class="nc" id="L151">            System.out.println(err.getMessage());</span>
<span class="nc" id="L152">            return false;</span>
<span class="nc" id="L153">        }</span>

<span class="nc" id="L155">        return isActive;</span>
    }
    boolean addCourse(String course_id,String title,String dept_id,int req_sem,double l,double t , double p,double credits,String course_type,int batch)
    {

<span class="nc" id="L160">        String insertQuery = &quot;insert into course_catalogue (course_id, title,dept_id, req_sem,l,t,p,credits,course_type,batch) values (?,?,?,?,?,?,?,?,?,?)&quot;;</span>
<span class="nc" id="L161">        course_id = course_id.toUpperCase();</span>
<span class="nc" id="L162">        dept_id = dept_id.toUpperCase();</span>
<span class="nc" id="L163">        String findCourse = &quot;select * from course where course_id = ?&quot;;</span>
<span class="nc bnc" id="L164" title="All 2 branches missed.">        if(!isAddCourseActive())</span>
        {
<span class="nc" id="L166">            System.out.println(&quot;Cannot Add course Now as current Activity is not allowing it!&quot;);</span>
<span class="nc" id="L167">            return false;</span>
        }
        try{
<span class="nc" id="L170">            PreparedStatement preparedStatement = this.con.prepareStatement(insertQuery);</span>
<span class="nc" id="L171">            preparedStatement.setString(1, removeSpaces(course_id));</span>
<span class="nc" id="L172">            preparedStatement.setString(2, removeSpaces(title));</span>
<span class="nc" id="L173">            preparedStatement.setString(3, removeSpaces(dept_id));</span>
<span class="nc" id="L174">            preparedStatement.setInt(4, req_sem);</span>
<span class="nc" id="L175">            preparedStatement.setDouble(5, l);</span>
<span class="nc" id="L176">            preparedStatement.setDouble(6, t);</span>
<span class="nc" id="L177">            preparedStatement.setDouble(7, p);</span>
<span class="nc" id="L178">            preparedStatement.setDouble(8, credits);</span>
<span class="nc" id="L179">            preparedStatement.setString(9, course_type);</span>
<span class="nc" id="L180">            preparedStatement.setInt(10, batch);</span>
<span class="nc" id="L181">            preparedStatement.execute();</span>

<span class="nc" id="L183">            preparedStatement = this.con.prepareStatement(findCourse);</span>
<span class="nc" id="L184">            preparedStatement.setString(1,course_id);</span>
<span class="nc" id="L185">            ResultSet rs = preparedStatement.executeQuery();</span>
<span class="nc bnc" id="L186" title="All 2 branches missed.">            if(rs.next())</span>
            {
<span class="nc" id="L188">                 String updateQuery = &quot;update course set dept_id = ?,req_sem = ?,l = ?,t = ?,p = ?,credits = ?  where course_id = ? &quot;;</span>
<span class="nc" id="L189">                 preparedStatement = this.con.prepareStatement(updateQuery);</span>

<span class="nc" id="L191">                 preparedStatement.setString(1,dept_id);</span>
<span class="nc" id="L192">                 preparedStatement.setInt(2,req_sem);</span>
<span class="nc" id="L193">                 preparedStatement.setDouble(3,l);</span>
<span class="nc" id="L194">                preparedStatement.setDouble(4,t);</span>
<span class="nc" id="L195">                preparedStatement.setDouble(5,p);</span>
<span class="nc" id="L196">                preparedStatement.setDouble(6,credits);</span>
<span class="nc" id="L197">                preparedStatement.setString(7,course_id);</span>

<span class="nc" id="L199">                preparedStatement.execute();</span>
<span class="nc" id="L200">            }</span>
            else
            {
<span class="nc" id="L203">                String insertCourseQuery = &quot;insert into course (course_id, title,dept_id, req_sem,l,t,p,credits) values (?,?,?,?,?,?,?,?)&quot;;</span>
<span class="nc" id="L204">                preparedStatement = this.con.prepareStatement(insertCourseQuery);</span>


<span class="nc" id="L207">                preparedStatement.setString(1, removeSpaces(course_id));</span>
<span class="nc" id="L208">                preparedStatement.setString(2, removeSpaces(title));</span>
<span class="nc" id="L209">                preparedStatement.setString(3, removeSpaces(dept_id));</span>
<span class="nc" id="L210">                preparedStatement.setInt(4, req_sem);</span>
<span class="nc" id="L211">                preparedStatement.setDouble(5, l);</span>
<span class="nc" id="L212">                preparedStatement.setDouble(6, t);</span>
<span class="nc" id="L213">                preparedStatement.setDouble(7, p);</span>
<span class="nc" id="L214">                preparedStatement.setDouble(8, credits);</span>

<span class="nc" id="L216">                preparedStatement.execute();</span>
            }



<span class="nc" id="L221">            preparedStatement.close();</span>
<span class="nc" id="L222">            rs.close();</span>
<span class="nc" id="L223">        }catch(SQLException err)</span>
        {
<span class="nc" id="L225">            System.out.println(err.getMessage());</span>
<span class="nc" id="L226">        }</span>
<span class="nc" id="L227">        return true;</span>
    }
    boolean isGradesSubmissionEnded()
    {
<span class="nc" id="L231">        String query = String.format(&quot;select * from current_session&quot;);</span>
<span class="nc" id="L232">        boolean isStarted = false;</span>

        try{
<span class="nc" id="L235">            PreparedStatement preparedStatement = this.con.prepareStatement(query);</span>
<span class="nc" id="L236">            ResultSet rs = preparedStatement.executeQuery();</span>
<span class="nc" id="L237">            rs.next();</span>
<span class="nc" id="L238">            int status = rs.getInt(&quot;status&quot;);</span>
<span class="nc bnc" id="L239" title="All 2 branches missed.">            if(status == this.GRADESUBMITEND)</span>
            {
<span class="nc" id="L241">                isStarted = true;</span>
            }

<span class="nc" id="L244">        }catch(SQLException err)</span>
        {
<span class="nc" id="L246">            System.out.println(err.getMessage());</span>
<span class="nc" id="L247">            return false;</span>
<span class="nc" id="L248">        }</span>
<span class="nc" id="L249">        return isStarted;</span>
    }
    protected boolean promote(String csvFile,int year)
    {
<span class="nc" id="L253">        String updateQuery = &quot;update student set current_sem = current_sem +1 where student_id = ?&quot;;</span>
<span class="nc" id="L254">        boolean submitGradeEnd = isGradesSubmissionEnded();</span>
<span class="nc bnc" id="L255" title="All 2 branches missed.">        if(!submitGradeEnd)</span>
        {
<span class="nc" id="L257">            System.out.println(&quot;Grades submission has not ended yet! So no promotion&quot;);</span>
<span class="nc" id="L258">            return false;</span>
        }

        try{
<span class="nc" id="L262">            Connection connection = this.con;</span>
<span class="nc" id="L263">            PreparedStatement preparedStatement = null ;</span>
<span class="nc" id="L264">            BufferedReader br = new BufferedReader(new FileReader(csvFile));</span>
            String line;
<span class="nc" id="L266">            br.readLine();</span>

<span class="nc bnc" id="L268" title="All 2 branches missed.">            while ((line = br.readLine()) != null) {</span>

<span class="nc" id="L270">                String[] data = line.split(&quot;,&quot;);</span>

<span class="nc" id="L272">                String std_id = removeSpaces(data[0]);</span>
<span class="nc" id="L273">                preparedStatement = connection.prepareStatement(updateQuery);</span>
<span class="nc" id="L274">                preparedStatement.setString(1,std_id);</span>
<span class="nc" id="L275">                preparedStatement.executeUpdate();</span>

<span class="nc" id="L277">            }</span>

<span class="nc" id="L279">            preparedStatement.close();</span>
<span class="nc" id="L280">            System.out.println(&quot;Promoted Successfully!&quot;);</span>

<span class="nc" id="L282">        }catch(Exception err)</span>
        {
<span class="nc" id="L284">            System.out.println(err.getMessage());</span>
<span class="nc" id="L285">        }</span>


<span class="nc" id="L288">        return true;</span>
    }
    protected boolean demote(String csvFile,int year)
    {
<span class="nc" id="L292">        String updateQuery = &quot;update student set current_sem = current_sem -1 where student_id = ?&quot;;</span>
<span class="nc" id="L293">        boolean submitGradeEnd = isGradesSubmissionEnded();</span>
<span class="nc bnc" id="L294" title="All 2 branches missed.">        if(!submitGradeEnd)</span>
        {
<span class="nc" id="L296">            System.out.println(&quot;Grades submission has not ended yet! So no promotion&quot;);</span>
<span class="nc" id="L297">            return false;</span>
        }

        try{
<span class="nc" id="L301">            Connection connection = this.con;</span>
<span class="nc" id="L302">            PreparedStatement preparedStatement = null ;</span>
<span class="nc" id="L303">            BufferedReader br = new BufferedReader(new FileReader(csvFile));</span>
            String line;
<span class="nc" id="L305">            br.readLine();</span>

<span class="nc bnc" id="L307" title="All 2 branches missed.">            while ((line = br.readLine()) != null) {</span>

<span class="nc" id="L309">                String[] data = line.split(&quot;,&quot;);</span>

<span class="nc" id="L311">                String std_id = removeSpaces(data[0]);</span>
<span class="nc" id="L312">                preparedStatement = connection.prepareStatement(updateQuery);</span>
<span class="nc" id="L313">                preparedStatement.setString(1,std_id);</span>
<span class="nc" id="L314">                preparedStatement.executeUpdate();</span>

<span class="nc" id="L316">            }</span>

<span class="nc" id="L318">            preparedStatement.close();</span>
<span class="nc" id="L319">            System.out.println(&quot;demoted Successfully!&quot;);</span>

<span class="nc" id="L321">        }catch(Exception err)</span>
        {
<span class="nc" id="L323">            System.out.println(err.getMessage());</span>
<span class="nc" id="L324">        }</span>


<span class="nc" id="L327">        return true;</span>
    }

    boolean generateTranscript(String student_id)
    {
<span class="nc" id="L332">        student_id = removeSpaces(student_id);</span>
<span class="nc" id="L333">        student_id = student_id.toLowerCase();</span>

<span class="nc" id="L335">        String stdSemQuery = &quot;select * from student where student_id = ?&quot;;</span>

<span class="nc" id="L337">        int stdSem = 0;</span>
<span class="nc" id="L338">        int stdAdmYear = extractIntegral(student_id);</span>

        try{
<span class="nc" id="L341">            PreparedStatement preparedStatement = this.con.prepareStatement(stdSemQuery);</span>
<span class="nc" id="L342">            preparedStatement.setString(1,student_id);</span>
<span class="nc" id="L343">            ResultSet rs = preparedStatement.executeQuery();</span>
<span class="nc bnc" id="L344" title="All 2 branches missed.">            if(rs.next())</span>
            {
<span class="nc" id="L346">                stdSem = rs.getInt(&quot;current_sem&quot;);</span>
//                System.out.println(stdSem);
            }else {
<span class="nc" id="L349">                System.out.println(&quot;NO Student with this ID Found!&quot;);</span>
<span class="nc" id="L350">                return false;</span>
            }
<span class="nc" id="L352">            String filePath = &quot;/home/ashish/hdd/study/java_proj/AIIMSPortal/src/main/Transcripts/&quot;;</span>

<span class="nc" id="L354">            BufferedWriter writer = new BufferedWriter(new FileWriter(filePath +student_id + &quot;_transcript.txt&quot;));</span>

<span class="nc" id="L356">            writer.write(&quot;Transcript for Student ID &quot; + student_id + &quot;\n&quot;);</span>

//            System.out.println(calculateCGPA(this.con,student_id,extractIntegral(student_id)));
<span class="nc" id="L359">            String query = &quot;SELECT * FROM student_record_&quot;+stdAdmYear+&quot; WHERE student_id = ? and semester = ?  &quot;;</span>
<span class="nc" id="L360">            preparedStatement = null;</span>
<span class="nc" id="L361">            String title = &quot;&quot;;</span>
<span class="nc" id="L362">            double totCumulativeCredits = 0.0;</span>
<span class="nc bnc" id="L363" title="All 2 branches missed.">            for(int i =1 ;i&lt;=stdSem;i++)</span>
            {
<span class="nc" id="L365">                title = &quot;SEMESTER &quot; + i;</span>
<span class="nc" id="L366">                preparedStatement = this.con.prepareStatement(query);</span>
<span class="nc" id="L367">                preparedStatement.setString(1, student_id);</span>
<span class="nc" id="L368">                preparedStatement.setInt(2,i);</span>
<span class="nc" id="L369">                rs = preparedStatement.executeQuery();</span>
//                printResultTable(rs);

<span class="nc" id="L372">                double totCredits = 0;</span>
<span class="nc" id="L373">                ArrayList&lt;ArrayList&lt;String&gt;&gt; arr = new ArrayList&lt;&gt;();</span>
<span class="nc" id="L374">                ArrayList&lt;String&gt; row = new ArrayList&lt;&gt;();</span>
<span class="nc" id="L375">                row.add(&quot;CourseID&quot;);</span>
<span class="nc" id="L376">                row.add(&quot;Grades&quot;);</span>
<span class="nc" id="L377">                row.add(&quot;Credits&quot;);</span>
<span class="nc" id="L378">                arr.add(row);</span>

<span class="nc bnc" id="L380" title="All 2 branches missed.">                while (rs.next()) {</span>
<span class="nc" id="L381">                    String courseId = rs.getString(&quot;course_id&quot;);</span>
<span class="nc" id="L382">                    String grade = rs.getString(&quot;grades&quot;);</span>
<span class="nc" id="L383">                    Double creditsEarned = rs.getDouble(&quot;credits&quot;);</span>

<span class="nc" id="L385">                    row = new ArrayList&lt;&gt;();</span>
<span class="nc" id="L386">                    row.add(courseId);</span>
<span class="nc" id="L387">                    row.add(grade);</span>
<span class="nc" id="L388">                    row.add(String.valueOf(creditsEarned));</span>
<span class="nc" id="L389">                    arr.add(row);</span>

<span class="nc" id="L391">                    totCredits += creditsEarned;</span>
<span class="nc" id="L392">                }</span>
<span class="nc" id="L393">                double cgpa = this.calculateCGPA(this.con,student_id,stdAdmYear,i);</span>
<span class="nc" id="L394">                double sgpa = this.calculateSGPA(this.con,student_id,stdAdmYear,i);</span>

<span class="nc" id="L396">                totCumulativeCredits += totCredits;</span>
<span class="nc" id="L397">                row = new ArrayList&lt;&gt;();</span>
<span class="nc" id="L398">                row.add(&quot;CGPA = &quot;+cgpa);</span>
<span class="nc" id="L399">                row.add(&quot;SGPA = &quot;+sgpa);</span>
<span class="nc" id="L400">                row.add(&quot;Total earned credits = &quot; +totCredits);</span>
<span class="nc" id="L401">                arr.add(row);</span>

<span class="nc" id="L403">                System.out.println(&quot;data for sem &quot;+i+ &quot; added&quot;);</span>

<span class="nc" id="L405">                writer.write(CLI.getFormedTable(title,arr));</span>

<span class="nc" id="L407">                writer.write(&quot;\n\n\n\n&quot;);</span>

            }
<span class="nc" id="L410">            writer.close();</span>

<span class="nc" id="L412">            rs.close();</span>
<span class="nc" id="L413">            preparedStatement.close();</span>

<span class="nc" id="L415">        }catch(Exception err)</span>
        {
<span class="nc" id="L417">            System.out.println(err.getMessage());</span>
<span class="nc" id="L418">            System.out.println(&quot;Transcript NOT Generated!&quot;);</span>
<span class="nc" id="L419">            return false;</span>
<span class="nc" id="L420">        }</span>

<span class="nc" id="L422">        System.out.println(&quot;Transcript Generated!&quot;);</span>
<span class="nc" id="L423">        return true;</span>
    }
    boolean generateTranscriptForAll(int year)
    {
<span class="nc" id="L427">        String query = &quot;select student_id from student_record_&quot;+year+&quot; group by student_id&quot;;</span>
        try{
<span class="nc" id="L429">            PreparedStatement preparedStatement = this.con.prepareStatement(query);</span>
<span class="nc" id="L430">            ResultSet rs = preparedStatement.executeQuery();</span>

<span class="nc bnc" id="L432" title="All 2 branches missed.">            while(rs.next())</span>
            {
<span class="nc" id="L434">                generateTranscript(rs.getString(&quot;student_id&quot;));</span>
            }

<span class="nc" id="L437">        }catch(Exception err)</span>
        {
<span class="nc" id="L439">            System.out.println(err.getMessage());</span>
<span class="nc" id="L440">        }</span>
<span class="nc" id="L441">        return true;</span>
    }
    boolean logOut() throws SQLException {
<span class="nc" id="L444">           this.con.close();</span>
<span class="nc" id="L445">        System.out.println(&quot;Admin Successfully logged out!&quot;);</span>
<span class="nc" id="L446">        return true;</span>
    }

    boolean printMainMenu()
    {
<span class="nc" id="L451">        ArrayList&lt;ArrayList&lt;String&gt;&gt; officerMainMenu = new ArrayList&lt;&gt;();</span>
<span class="nc" id="L452">        String title = &quot;MAIN MENU&quot;;</span>
<span class="nc" id="L453">        ArrayList&lt;String&gt; row = new ArrayList&lt;&gt;();</span>

<span class="nc" id="L455">        row.add(&quot;Options&quot;);</span>
<span class="nc" id="L456">        row.add(&quot;Enter Choice&quot;);</span>
<span class="nc" id="L457">        officerMainMenu.add(row);</span>

<span class="nc" id="L459">        row = new ArrayList&lt;&gt;();</span>
<span class="nc" id="L460">        row.add(&quot;Change Profile&quot;);</span>
<span class="nc" id="L461">        row.add(&quot;1&quot;);</span>
<span class="nc" id="L462">        officerMainMenu.add(row);</span>

<span class="nc" id="L464">        row = new ArrayList&lt;&gt;();</span>
<span class="nc" id="L465">        row.add(&quot;Create Session&quot;);</span>
<span class="nc" id="L466">        row.add(&quot;2&quot;);</span>
<span class="nc" id="L467">        officerMainMenu.add(row);</span>

<span class="nc" id="L469">        row = new ArrayList&lt;&gt;();</span>
<span class="nc" id="L470">        row.add(&quot;Create New Activity&quot;);</span>
<span class="nc" id="L471">        row.add(&quot;3&quot;);</span>
<span class="nc" id="L472">        officerMainMenu.add(row);</span>

<span class="nc" id="L474">        row = new ArrayList&lt;&gt;();</span>
<span class="nc" id="L475">        row.add(&quot;See Course Catalogue&quot;);</span>
<span class="nc" id="L476">        row.add(&quot;4&quot;);</span>
<span class="nc" id="L477">        officerMainMenu.add(row);</span>

<span class="nc" id="L479">        row = new ArrayList&lt;&gt;();</span>
<span class="nc" id="L480">        row.add(&quot;Add new Course&quot;);</span>
<span class="nc" id="L481">        row.add(&quot;5&quot;);</span>
<span class="nc" id="L482">        officerMainMenu.add(row);</span>

<span class="nc" id="L484">        row = new ArrayList&lt;&gt;();</span>
<span class="nc" id="L485">        row.add(&quot;Genereate Student Transcript&quot;);</span>
<span class="nc" id="L486">        row.add(&quot;6&quot;);</span>
<span class="nc" id="L487">        officerMainMenu.add(row);</span>

<span class="nc" id="L489">        row = new ArrayList&lt;&gt;();</span>
<span class="nc" id="L490">        row.add(&quot;Promote Students&quot;);</span>
<span class="nc" id="L491">        row.add(&quot;7&quot;);</span>
<span class="nc" id="L492">        officerMainMenu.add(row);</span>

<span class="nc" id="L494">        CLI.printMenu(title,officerMainMenu);</span>

<span class="nc" id="L496">        return true;</span>
    }

    boolean printActivityMenu()
    {
<span class="nc" id="L501">        ArrayList&lt;ArrayList&lt;String&gt;&gt; officerMainMenu = new ArrayList&lt;&gt;();</span>
<span class="nc" id="L502">        String title = &quot;ACTIVITY MENU&quot;;</span>
<span class="nc" id="L503">        ArrayList&lt;String&gt; row = new ArrayList&lt;&gt;();</span>

<span class="nc" id="L505">        row.add(&quot;Options&quot;);</span>
<span class="nc" id="L506">        row.add(&quot;Enter Choice&quot;);</span>
<span class="nc" id="L507">        officerMainMenu.add(row);</span>

<span class="nc" id="L509">        row = new ArrayList&lt;&gt;();</span>
<span class="nc" id="L510">        row.add(&quot;Semester Running&quot;);</span>
<span class="nc" id="L511">        row.add(&quot;0&quot;);</span>
<span class="nc" id="L512">        officerMainMenu.add(row);</span>

<span class="nc" id="L514">        row = new ArrayList&lt;&gt;();</span>
<span class="nc" id="L515">        row.add(&quot;Course Float Starts&quot;);</span>
<span class="nc" id="L516">        row.add(&quot;1&quot;);</span>
<span class="nc" id="L517">        officerMainMenu.add(row);</span>

<span class="nc" id="L519">        row = new ArrayList&lt;&gt;();</span>
<span class="nc" id="L520">        row.add(&quot;Course Float Ends&quot;);</span>
<span class="nc" id="L521">        row.add(&quot;2&quot;);</span>
<span class="nc" id="L522">        officerMainMenu.add(row);</span>

<span class="nc" id="L524">        row = new ArrayList&lt;&gt;();</span>
<span class="nc" id="L525">        row.add(&quot;Student Registration Begins&quot;);</span>
<span class="nc" id="L526">        row.add(&quot;3&quot;);</span>
<span class="nc" id="L527">        officerMainMenu.add(row);</span>

<span class="nc" id="L529">        row = new ArrayList&lt;&gt;();</span>
<span class="nc" id="L530">        row.add(&quot;Student Registration Ends&quot;);</span>
<span class="nc" id="L531">        row.add(&quot;4&quot;);</span>
<span class="nc" id="L532">        officerMainMenu.add(row);</span>

<span class="nc" id="L534">        row = new ArrayList&lt;&gt;();</span>
<span class="nc" id="L535">        row.add(&quot;Grade Submission Begins&quot;);</span>
<span class="nc" id="L536">        row.add(&quot;5&quot;);</span>
<span class="nc" id="L537">        officerMainMenu.add(row);</span>

<span class="nc" id="L539">        row = new ArrayList&lt;&gt;();</span>
<span class="nc" id="L540">        row.add(&quot;Grade Submissin Ends&quot;);</span>
<span class="nc" id="L541">        row.add(&quot;6&quot;);</span>
<span class="nc" id="L542">        officerMainMenu.add(row);</span>

<span class="nc" id="L544">        row = new ArrayList&lt;&gt;();</span>
<span class="nc" id="L545">        row.add(&quot;Semester Starts&quot;);</span>
<span class="nc" id="L546">        row.add(&quot;7&quot;);</span>
<span class="nc" id="L547">        officerMainMenu.add(row);</span>

<span class="nc" id="L549">        row = new ArrayList&lt;&gt;();</span>
<span class="nc" id="L550">        row.add(&quot;Semester Ends&quot;);</span>
<span class="nc" id="L551">        row.add(&quot;8&quot;);</span>
<span class="nc" id="L552">        officerMainMenu.add(row);</span>


<span class="nc" id="L555">        CLI.printMenu(title,officerMainMenu);</span>

<span class="nc" id="L557">        return true;</span>
    }
    boolean printCourseTypeMenu()
    {
<span class="nc" id="L561">        ArrayList&lt;ArrayList&lt;String&gt;&gt; officerMainMenu = new ArrayList&lt;&gt;();</span>
<span class="nc" id="L562">        String title = &quot;COURSE TYPE MENU&quot;;</span>
<span class="nc" id="L563">        ArrayList&lt;String&gt; row = new ArrayList&lt;&gt;();</span>

<span class="nc" id="L565">        row.add(&quot;Options&quot;);</span>
<span class="nc" id="L566">        row.add(&quot;Enter Choice&quot;);</span>
<span class="nc" id="L567">        officerMainMenu.add(row);</span>

<span class="nc" id="L569">        row = new ArrayList&lt;&gt;();</span>
<span class="nc" id="L570">        row.add(&quot;Program core&quot;);</span>
<span class="nc" id="L571">        row.add(&quot;pc&quot;);</span>
<span class="nc" id="L572">        officerMainMenu.add(row);</span>

<span class="nc" id="L574">        row = new ArrayList&lt;&gt;();</span>
<span class="nc" id="L575">        row.add(&quot;Engineering Core&quot;);</span>
<span class="nc" id="L576">        row.add(&quot;ec&quot;);</span>
<span class="nc" id="L577">        officerMainMenu.add(row);</span>

<span class="nc" id="L579">        row = new ArrayList&lt;&gt;();</span>
<span class="nc" id="L580">        row.add(&quot;Elective Core&quot;);</span>
<span class="nc" id="L581">        row.add(&quot;el&quot;);</span>
<span class="nc" id="L582">        officerMainMenu.add(row);</span>


<span class="nc" id="L585">        CLI.printMenu(title,officerMainMenu);</span>

<span class="nc" id="L587">        return true;</span>
    }
    boolean printTranscriptMenu()
    {
<span class="nc" id="L591">        ArrayList&lt;ArrayList&lt;String&gt;&gt; transcriptMenu = new ArrayList&lt;&gt;();</span>
<span class="nc" id="L592">        String title = &quot;TRANSCRIPT MENU&quot;;</span>
<span class="nc" id="L593">        ArrayList&lt;String&gt; row = new ArrayList&lt;&gt;();</span>

<span class="nc" id="L595">        row.add(&quot;Options&quot;);</span>
<span class="nc" id="L596">        row.add(&quot;Enter Choice&quot;);</span>
<span class="nc" id="L597">        transcriptMenu.add(row);</span>

<span class="nc" id="L599">        row = new ArrayList&lt;&gt;();</span>
<span class="nc" id="L600">        row.add(&quot;Generate for single student&quot;);</span>
<span class="nc" id="L601">        row.add(&quot;1&quot;);</span>
<span class="nc" id="L602">        transcriptMenu.add(row);</span>

<span class="nc" id="L604">        row = new ArrayList&lt;&gt;();</span>
<span class="nc" id="L605">        row.add(&quot;Generate for a batch&quot;);</span>
<span class="nc" id="L606">        row.add(&quot;2&quot;);</span>
<span class="nc" id="L607">        transcriptMenu.add(row);</span>

<span class="nc" id="L609">        CLI.printMenu(title,transcriptMenu);</span>

<span class="nc" id="L611">        return true;</span>
    }
    public static void runOffice(String userId) throws SQLException {

<span class="nc" id="L615">        AcademicOffice officer = new AcademicOffice(userId);</span>
<span class="nc" id="L616">        String input = &quot;&quot;;</span>
<span class="nc" id="L617">        String exitSymbol = &quot;exit&quot;;</span>
<span class="nc" id="L618">        Scanner scanner = new Scanner(System.in);</span>



        while(true)
        {
<span class="nc" id="L624">            officer.printMainMenu();</span>
<span class="nc" id="L625">            CLI.inputTaker();</span>
<span class="nc" id="L626">            input = scanner.nextLine();</span>
<span class="nc" id="L627">            input = removeSpaces(input);</span>

<span class="nc bnc" id="L629" title="All 2 branches missed.">            if (input.equals(exitSymbol)) {</span>
<span class="nc" id="L630">                System.out.println(&quot;Exiting Officer Menu..&quot;);</span>
<span class="nc" id="L631">                break;</span>
            }
<span class="nc bnc" id="L633" title="All 2 branches missed.">            if(input.equals(&quot;1&quot;))</span>
            {
<span class="nc" id="L635">                String profile = &quot;&quot;;</span>
<span class="nc" id="L636">                officer.printChangeProfileMenu();</span>
                while(true)
                {
<span class="nc" id="L639">                    officer.printChangeProfileMenu();</span>
<span class="nc" id="L640">                    CLI.inputTaker();</span>
<span class="nc" id="L641">                    profile = scanner.nextLine();</span>
<span class="nc" id="L642">                    profile = removeSpaces(profile);</span>
<span class="nc bnc" id="L643" title="All 2 branches missed.">                    if(profile.equals(&quot;exit&quot;))</span>
                    {
<span class="nc" id="L645">                        System.out.println(&quot;Exiting Change Profile Menu..&quot;);</span>
<span class="nc" id="L646">                        break;</span>
                    }
<span class="nc bnc" id="L648" title="All 2 branches missed.">                    if(profile.equals(&quot;1&quot;))</span>
                    {
<span class="nc" id="L650">                        System.out.println(&quot;Enter New Name&quot;);</span>
<span class="nc" id="L651">                        CLI.inputTaker();</span>
<span class="nc" id="L652">                        String name = scanner.nextLine();</span>
<span class="nc" id="L653">                        officer.changeProfileName(name);</span>
<span class="nc" id="L654">                        System.out.println(&quot;Name Changed Succesfully&quot;);</span>

<span class="nc bnc" id="L656" title="All 2 branches missed.">                    }else if(profile.equals(&quot;2&quot;))</span>
                    {
<span class="nc" id="L658">                        System.out.println(&quot;Enter New Phone Number&quot;);</span>
<span class="nc" id="L659">                        CLI.inputTaker();</span>
<span class="nc" id="L660">                        String number = scanner.nextLine();</span>
<span class="nc" id="L661">                        officer.changeProfileNumber(number);</span>
<span class="nc" id="L662">                        System.out.println(&quot;Number Changed Succesfully&quot;);</span>
<span class="nc" id="L663">                    }else {</span>
<span class="nc" id="L664">                        System.out.println(&quot;Invalid Choice!&quot;);</span>
                    }
<span class="nc" id="L666">                    CLI.clearScreen();</span>
                }

<span class="nc bnc" id="L669" title="All 2 branches missed.">            }else if (input.equals(&quot;2&quot;))</span>
            {
<span class="nc" id="L671">                String input1 = &quot;&quot;;</span>
<span class="nc" id="L672">                System.out.println(&quot;Enter New Year of Academic Session: &quot;);</span>
<span class="nc" id="L673">                CLI.inputTaker();</span>
                try{
<span class="nc" id="L675">                    input1 = scanner.nextLine();</span>
<span class="nc" id="L676">                    input1 = removeSpaces(input1);</span>
<span class="nc" id="L677">                    int year = Integer.parseInt(input1);</span>

<span class="nc" id="L679">                    System.out.println(&quot;Enter New Year of Academic Session: &quot;);</span>
<span class="nc" id="L680">                    CLI.inputTaker();</span>
<span class="nc" id="L681">                    input1 = scanner.nextLine();</span>

<span class="nc" id="L683">                    int session = Integer.parseInt(input1);</span>
<span class="nc" id="L684">                    officer.setSession(year,session,officer.SEMEND);</span>
<span class="nc" id="L685">                }catch(Exception err)</span>
                {
<span class="nc" id="L687">                    System.out.println(err.getMessage());</span>
<span class="nc" id="L688">                }</span>
<span class="nc" id="L689">                CLI.clearScreen();</span>


<span class="nc bnc" id="L692" title="All 2 branches missed.">            }else if (input.equals(&quot;3&quot;))</span>
            {
<span class="nc" id="L694">                String status = &quot;&quot;;</span>
                while(true)
                {
<span class="nc" id="L697">                    officer.printActivityMenu();</span>
<span class="nc" id="L698">                    CLI.inputTaker();</span>
<span class="nc" id="L699">                    status = scanner.nextLine();</span>
<span class="nc bnc" id="L700" title="All 2 branches missed.">                    if(status.equals(exitSymbol))</span>
                    {
<span class="nc" id="L702">                        System.out.println(&quot;Exiting Activity Create Menu...&quot;);</span>
<span class="nc" id="L703">                        break;</span>
                    }
                    try
                    {
<span class="nc" id="L707">                        int session = Integer.parseInt(status);</span>
<span class="nc" id="L708">                        officer.createActivity(session);</span>

<span class="nc" id="L710">                        System.out.println(&quot;Activity Created Successfully!&quot;);</span>
<span class="nc" id="L711">                    }catch(Exception err)</span>
                    {
<span class="nc" id="L713">                        System.out.println(err.getMessage());</span>
<span class="nc" id="L714">                    }</span>
<span class="nc" id="L715">                    CLI.clearScreen();</span>

                }

<span class="nc bnc" id="L719" title="All 2 branches missed.">            }else if (input.equals(&quot;4&quot;))</span>
            {
<span class="nc" id="L721">                officer.viewCourseCatalogue(officer.con);</span>

<span class="nc bnc" id="L723" title="All 2 branches missed.">            }else if (input.equals(&quot;5&quot;))</span>
            {
<span class="nc" id="L725">                String input1 = &quot;&quot;;</span>
<span class="nc" id="L726">                System.out.println(&quot;Add Course: &quot;);</span>
                while(true)
                {
<span class="nc" id="L729">                    System.out.println(&quot;To exit this menu enter exit or press any key to continue&quot;);</span>
<span class="nc" id="L730">                    CLI.inputTaker();</span>
<span class="nc" id="L731">                    input1 = scanner.nextLine();</span>
<span class="nc bnc" id="L732" title="All 2 branches missed.">                    if(input1.equals(exitSymbol))</span>
                    {
<span class="nc" id="L734">                        System.out.println(&quot;Exiting Adding Course Menu&quot;);</span>
<span class="nc" id="L735">                        break;</span>
                    }
                    try{
<span class="nc" id="L738">                        System.out.println(&quot;Enter Course ID: &quot;);</span>
<span class="nc" id="L739">                        CLI.inputTaker();</span>
<span class="nc" id="L740">                        String course_id = scanner.nextLine();</span>

<span class="nc" id="L742">                        System.out.println(&quot;Enter course Title: &quot;);</span>
<span class="nc" id="L743">                        CLI.inputTaker();</span>
<span class="nc" id="L744">                        String title = scanner.nextLine();</span>

<span class="nc" id="L746">                        System.out.println(&quot;Enter course department: &quot;);</span>
<span class="nc" id="L747">                        CLI.inputTaker();</span>
<span class="nc" id="L748">                        String dept_id = scanner.nextLine();</span>

<span class="nc" id="L750">                        System.out.println(&quot;Enter Minimum required Semester&quot;);</span>
<span class="nc" id="L751">                        CLI.inputTaker();</span>
<span class="nc" id="L752">                        String req_sem = scanner.nextLine();</span>

<span class="nc" id="L754">                        System.out.println(&quot;Enter Number of lectures per week :&quot;);</span>
<span class="nc" id="L755">                        CLI.inputTaker();</span>
<span class="nc" id="L756">                        String l = scanner.nextLine();</span>

<span class="nc" id="L758">                        System.out.println(&quot;Enter Number of tutorial per week :&quot;);</span>
<span class="nc" id="L759">                        CLI.inputTaker();</span>
<span class="nc" id="L760">                        String t = scanner.nextLine();</span>

<span class="nc" id="L762">                        System.out.println(&quot;Enter Number of p per week :&quot;);</span>
<span class="nc" id="L763">                        CLI.inputTaker();</span>
<span class="nc" id="L764">                        String p = scanner.nextLine();</span>

<span class="nc" id="L766">                        System.out.println(&quot;Enter Number of credits :&quot;);</span>
<span class="nc" id="L767">                        CLI.inputTaker();</span>
<span class="nc" id="L768">                        String credits = scanner.nextLine();</span>

<span class="nc" id="L770">                        System.out.println(&quot;Enter Course Type:&quot;);</span>
<span class="nc" id="L771">                        String type = &quot;&quot;;</span>
                        while(true)
                        {
<span class="nc" id="L774">                            officer.printCourseTypeMenu();</span>
<span class="nc" id="L775">                            CLI.inputTaker();</span>
<span class="nc" id="L776">                            type = scanner.nextLine();</span>
<span class="nc bnc" id="L777" title="All 2 branches missed.">                            if(type.equals(officer.ENGCORETYPE))</span>
                            {
<span class="nc" id="L779">                                type = officer.ENGCORETYPE;</span>
<span class="nc" id="L780">                                break;</span>
<span class="nc bnc" id="L781" title="All 2 branches missed.">                            }else if(type.equals(officer.ELECCORETYPE))</span>
                            {
<span class="nc" id="L783">                                type = officer.ELECCORETYPE;</span>
<span class="nc" id="L784">                                break;</span>
                            }
<span class="nc bnc" id="L786" title="All 2 branches missed.">                            else if(type.equals(officer.PROCORETYPE))</span>
                            {
<span class="nc" id="L788">                                type = officer.PROCORETYPE;break;</span>
                            }
                            else {
<span class="nc" id="L791">                                System.out.println(&quot;Invalid Course Type! Enter Again:&quot;);</span>
                            }
                        }

<span class="nc" id="L795">                        System.out.println(&quot;Enter Batch year above which this course configuration is valid :&quot;);</span>
<span class="nc" id="L796">                        CLI.inputTaker();</span>
<span class="nc" id="L797">                        String batch = scanner.nextLine();</span>

<span class="nc" id="L799">                        officer.addCourse(course_id,title,dept_id,Integer.parseInt(req_sem),Double.parseDouble(l),</span>
<span class="nc" id="L800">                                Double.parseDouble(t),Double.parseDouble(p),</span>
<span class="nc" id="L801">                                Double.parseDouble(credits),type,Integer.parseInt(batch));</span>

<span class="nc" id="L803">                        System.out.println(&quot;Course Added Successfully!&quot;);</span>

<span class="nc" id="L805">                    }catch(Exception err)</span>
                    {
<span class="nc" id="L807">                        System.out.println(err.getMessage());</span>
<span class="nc" id="L808">                    }</span>
                }

<span class="nc bnc" id="L811" title="All 2 branches missed.">            }else if (input.equals(&quot;6&quot;))</span>
            {
<span class="nc" id="L813">                String input1 = &quot;&quot;;</span>
                while(true)
                {

<span class="nc" id="L817">                    System.out.println(&quot;Enter exit to go back or any other string to move forward&quot;);</span>
<span class="nc" id="L818">                    CLI.inputTaker();</span>
<span class="nc" id="L819">                    input1 = scanner.nextLine();</span>

<span class="nc bnc" id="L821" title="All 2 branches missed.">                    if(input1.equals(exitSymbol))</span>
                    {
<span class="nc" id="L823">                        System.out.println(&quot;Exiting Generate Transcript Menu&quot;);</span>
<span class="nc" id="L824">                        break;</span>
                    }
<span class="nc" id="L826">                    officer.printTranscriptMenu();</span>
<span class="nc" id="L827">                    input1 = scanner.nextLine();</span>
<span class="nc bnc" id="L828" title="All 2 branches missed.">                    if(input1.equals(&quot;1&quot;))</span>
                    {
<span class="nc" id="L830">                        System.out.println(&quot;Enter the ID of the student to generate his transcript&quot;);</span>
<span class="nc" id="L831">                        CLI.inputTaker();</span>
<span class="nc" id="L832">                        String student_id = scanner.nextLine();</span>
<span class="nc" id="L833">                        officer.generateTranscript(student_id);</span>
<span class="nc" id="L834">                    }</span>
<span class="nc bnc" id="L835" title="All 2 branches missed.">                    else if(input1.equals(&quot;2&quot;))</span>
                    {
<span class="nc" id="L837">                        System.out.println(&quot;Enter the Year of the whose transcript you want to generate &quot;);</span>
<span class="nc" id="L838">                        CLI.inputTaker();</span>
<span class="nc" id="L839">                        String year = scanner.nextLine();</span>
<span class="nc" id="L840">                        year = removeSpaces(year);</span>
<span class="nc" id="L841">                        officer.generateTranscriptForAll(Integer.parseInt(year));</span>

<span class="nc" id="L843">                    }else{</span>
<span class="nc" id="L844">                        System.out.println(&quot;wrong Choice&quot;);</span>
                    }
                }



<span class="nc bnc" id="L850" title="All 2 branches missed.">            }else if(input.equals(&quot;7&quot;))</span>
            {
<span class="nc" id="L852">                String input1 = &quot;&quot;;</span>
<span class="nc" id="L853">                String csvFile = &quot;&quot;;</span>
                while(true)
                {
<span class="nc" id="L856">                    System.out.println(&quot;Enter exit to go back or any other string to move forward&quot;);</span>
<span class="nc" id="L857">                    CLI.inputTaker();</span>
<span class="nc" id="L858">                    input1 = scanner.nextLine();</span>
<span class="nc bnc" id="L859" title="All 2 branches missed.">                    if(input1.equals(exitSymbol))</span>
                    {
<span class="nc" id="L861">                        System.out.println(&quot;Exiting give grades Menu&quot;);</span>
<span class="nc" id="L862">                        break;</span>
                    }
<span class="nc" id="L864">                    System.out.println(&quot;Enter the year of the students whom you want to promote to next sem&quot;);</span>
<span class="nc" id="L865">                    CLI.inputTaker();</span>
<span class="nc" id="L866">                    String year = scanner.nextLine();</span>
<span class="nc" id="L867">                    System.out.println(&quot;Give the path of the CSV file&quot;);</span>
<span class="nc" id="L868">                    CLI.inputTaker();</span>
<span class="nc" id="L869">                    csvFile = scanner.nextLine();</span>
                    try{
<span class="nc" id="L871">                        officer.promote(csvFile,Integer.parseInt(year));</span>
<span class="nc" id="L872">                    }catch(Exception err)</span>
                    {
<span class="nc" id="L874">                        System.out.println(err.getMessage());</span>
<span class="nc" id="L875">                    }</span>
<span class="nc" id="L876">                }</span>
<span class="nc" id="L877">            }</span>
            else
            {
<span class="nc" id="L880">                System.out.println(&quot;Invalid Choice!&quot;);</span>
            }



        }
<span class="nc" id="L886">        officer.logOut();</span>

//        officer.setSession(2020,1, officer.GRADESUBMITSART);
//        officer.changeProfileNumber(&quot;7667247058&quot;);
//        officer.createActivity(1);

//        cs302,Algorithm Design,CSE,5,3,1,0,3,PC,2020
//        cs101,Discrete Mathematics,CSE,3,1,0		PC	2020
//        cs201	Data Structures	3,1,2	ge103	PC	2020
//        GE103	Introduction to Computing and Data Structures	3,0,3		EC	2020
//
//        officer.addCourse(&quot;CS201&quot;,&quot;Data Structures&quot;,&quot;CSE&quot;,2,3.0,1.0,2.0,3.0,&quot;pc&quot;,2020);

//        officer.viewCourseCatalogue(officer.con);
//        officer.viewCourseCatalogue(officer.con);


<span class="nc" id="L903">    }</span>
//    public static void main(String[] args) throws SQLException {
//        AcademicOffice officer = new AcademicOffice(&quot;staffdeanoffice@iitrpr.ac.in&quot;);
//
////        officer.generateTranscriptForAll(2020);
//        officer.setSession(2020,1,5);
////        String path = &quot;/home/ashish/hdd/study/java_proj/AIIMSPortal/src/main/java/org/example/seedData/give_grades_test.csv&quot;;
////        officer.giveGrades(path,2020);
////        officer.changeProfileNumber(&quot;999999&quot;);
//            officer.logOut();
//
//
//    }

}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.8.202204050719</span></div></body></html>